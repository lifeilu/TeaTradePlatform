<div ng-include src="'partials/header.html'"></div>
<div style="border:1px solid;border-color:rgba(0,0,0,.1);padding:0px 10px;" class="panel-group source-frame"
     id="accordion">
    <div class="panel panel-default " id="orderpanel">
        <div class="row ">
            <div class="col-md-12 col-sm-12 col-xs-12">
                <div style="height:auto">
                    <div class="row recommend-nav">
                        <div class="col-md-10 col-sm-10 col-xs-10 bigtitle">
                            <!--<img src="images/add/aishangtaoke.svg">-->
                            全部众包
                        </div>
                        <div class="col-md-2 col-sm-2 col-xs-2 ">
                          <button class="btn btn-list btn-w-md " ui-sref="addsource">发起众包</button>
                        </div>
                    </div>

                </div>
            </div>


        </div>  
        <div class="row">
            <div ng-repeat="source in sources | orderBy:'id'">
                <table class="myorder" style="word-break:normal; word-wrap:break-all;">
                  <tr>
                    <td style="color:#B0C330;width:200px">茶叶图片</td>
                    <td style="color:#B0C330;width:120px">茶叶名称</td>
                    <td style="color:#B0C330;width:90px">每份定金</td>
                    <td style="color:#B0C330;width:90px">每份数量</td>
                    <td style="color:#B0C330;width:90px">每份金额</td>
                    <td style="color:#B0C330;width:120px">开始时间</td>
                    <td style="color:#B0C330;width:120px">结束时间</td>
                    <td style="color:#B0C330;width:120px">发货时间</td>
                    <td style="color:#B0C330;width:90px">参与人数</td>
                    <td style="color:#B0C330;width:180px">剩余</td>
                    <td style="color:#B0C330;width:90px;">状态</td>
                    <td style="color:#B0C330;width:200px">操作</td>
                  </tr>
                  <tr>
                    <td>
                      <img style="width:150px" src="/api/image/getByUrl?url={{source.product.url}}">
                    </td>
                    <td width="120px">
                      {{source.product.name}}
                    </td>
                    <td width="90px">
                      <span>{{source.earnest}}元</span>
                    </td>
                    <td width="90px">
                      <span>{{source.unitNum}}两</span>
                    </td>
                    <td width="90px">
                      <span>{{source.unitMoney}}元</span>
                    </td>
                    <td width="120px">
                      <span>{{source.createDate}}</span>
                    </td>
                    <td width="120px">
                      <span>{{source.dealDate}}</span>
                    </td>   
                    <td width="120px">
                      <span>{{source.deliverDate}}</span>
                    </td>
                    <td width="90px">
                      <span>{{source.joinNum}}</span>
                    </td>
                    <td width="180px">
                      <div class="progress" style = "width:130px" >
                        <div class="progress-bar progress-bar-success progress-bar-striped active" style="width: {{source.progress}};">
                          <div class="progress-value">{{source.proval}}</div>
                        </div>
                      </div>
                    </td>
                    <td width="90px">
                      <span>{{stateEnum[source.state]}}</span>
                    </td>     
                    <td width="200px">
                      <a width = "60px" ng-click="cancel(source)" ng-show = "source.state==0&&source.joinNum==0" style = "cursor:pointer">取消&nbsp</a>
                      <a width = "60px" ng-click="confirm(source)" ng-show = "source.state==0" style = "cursor:pointer">结束&nbsp</a>
                      <a width = "60px" ui-sref="modifysource({data:source.id})" ng-show = "source.state==0&&source.joinNum==0" style = "cursor:pointer">&nbsp修改</a>
                    </td>              
                  </tr>
                </table>
                <hr class="myorder col-md-12 col-xs-12 col-sm-12">                              
            </div>  
        </div>
    <button ng-disabled="nowPage == 1" class="btn btn-list btn-w-md" ng-click="prev()">上一页</button>
    <input ng-model = "page" style="width:3%">
    <button class="btn btn-list btn-w-md" ng-click="jump()">跳转</button>
    {{nowPage}}
    /
    {{totalPage}}
    <button ng-disabled="nowPage >= totalPage" class="btn btn-list btn-w-md" ng-click="next()">下一页</button>
  </div>
</div>

